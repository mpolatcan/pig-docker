#!/usr/bin/env bash
function load_config() {
  if [[ "$2" != "NULL" ]]
    then
      printf "$1=$2\n" >> "${PIG_CONF_DIR}/$3"
  fi
}

printf "" > "${PIG_CONF_DIR}/pig.properties"
load_config "aggregate.warning" ${AGGREGATE_WARNING} "pig.properties"
load_config "brief" ${BRIEF} "pig.properties"
load_config "debug" ${DEBUG} "pig.properties"
load_config "exectype" ${EXECTYPE} "pig.properties"
load_config "file" ${FILE} "pig.properties"
load_config "hcat.bin" ${HCAT_BIN} "pig.properties"
load_config "jar" ${JAR} "pig.properties"
load_config "log4jconf" ${LOG4JCONF} "pig.properties"
load_config "opt.multiquery" ${OPT_MULTIQUERY} "pig.properties"
load_config "opt.fetch" ${OPT_FETCH} "pig.properties"
load_config "pig.cachedbag.memusage" ${PIG_CACHEDBAG_MEMUSAGE} "pig.properties"
load_config "pig.skewedjoin.reduce.memusage" ${PIG_SKEWEDJOIN_REDUCE_MEMUSAGE} "pig.properties"
load_config "pig.exec.nocombiner" ${PIG_EXEC_NOCOMBINER} "pig.properties"
load_config "pig.exec.nocombiner.reducer" ${PIG_EXEC_NOCOMBINER_REDUCER} "pig.properties"
load_config "pig.exec.mapPartAgg" ${PIG_EXEC_MAPPARTAGG} "pig.properties"
load_config "pig.exec.mapPartAgg.minReduction" ${PIG_EXEC_MAPPARTAGG_MINREDUCTION} "pig.properties"
load_config "pig.exec.reducers.bytes.per.reducer" ${PIG_EXEC_REDUCERS_BYTES_PER_REDUCER} "pig.properties"
load_config "pig.exec.reducers.max" ${PIG_EXEC_REDUCERS_MAX} "pig.properties"
load_config "pig.exec.reducer.estimator" ${PIG_EXEC_REDUCER_ESTIMATOR} "pig.properties"
load_config "pig.exec.reducer.estimator.arg" ${PIG_EXEC_REDUCER_ESTIMATOR_ARG} "pig.properties"
load_config "pig.tmpfilecompression" ${PIG_TMPFILECOMPRESSION} "pig.properties"
load_config "pig.tmpfilecompression.codec" ${PIG_TMPFILECOMPRESSION_CODEC} "pig.properties"
load_config "pig.tmpfilecompression.storage" ${PIG_TMPFILECOMPRESSION_STORAGE} "pig.properties"
load_config "pig.noSplitCombination" ${PIG_NOSPLITCOMBINATION} "pig.properties"
load_config "pig.additional.jars.uris" ${PIG_ADDITIONAL_JARS_URIS} "pig.properties"
load_config "pig.datetime.default.tz" ${PIG_DATETIME_DEFAULT_TZ} "pig.properties"
load_config "pig.artifacts.download.location" ${PIG_ARTIFACTS_DOWNLOAD_LOCATION} "pig.properties"
load_config "pig.user.cache.enabled" ${PIG_USER_CACHE_ENABLED} "pig.properties"
load_config "pig.user.cache.location" ${PIG_USER_CACHE_LOCATION} "pig.properties"
load_config "pig.user.cache.replication" ${PIG_USER_CACHE_REPLICATION} "pig.properties"
load_config "pig.spill.size.threshold" ${PIG_SPILL_SIZE_THRESHOLD} "pig.properties"
load_config "pig.spill.gc.activation.size" ${PIG_SPILL_GC_ACTIVATION_SIZE} "pig.properties"
load_config "pig.spill.memory.usage.threshold.fraction" ${PIG_SPILL_MEMORY_USAGE_THRESHOLD_FRACTION} "pig.properties"
load_config "pig.spill.collection.threshold.fraction" ${PIG_SPILL_COLLECTION_THRESHOLD_FRACTION} "pig.properties"
load_config "pig.spill.unused.memory.threshold.size" ${PIG_SPILL_UNUSED_MEMORY_THRESHOLD_SIZE} "pig.properties"
load_config "pig.join.replicated.max.bytes" ${PIG_JOIN_REPLICATED_MAX_BYTES} "pig.properties"
load_config "pig.schematuple" ${PIG_SCHEMATUPLE} "pig.properties"
load_config "pig.schematuple.udf" ${PIG_SCHEMATUPLE_UDF} "pig.properties"
load_config "pig.schematuple.load" ${PIG_SCHEMATUPLE_LOAD} "pig.properties"
load_config "pig.schematuple.fr_join" ${PIG_SCHEMATUPLE_FR_JOIN} "pig.properties"
load_config "pig.schematuple.merge_join" ${PIG_SCHEMATUPLE_MERGE_JOIN} "pig.properties"
load_config "pig.output.lazy" ${PIG_OUTPUT_LAZY} "pig.properties"
load_config "pig.output.committer.recovery.support" ${PIG_OUTPUT_COMMITTER_RECOVERY_SUPPORT} "pig.properties"
load_config "pig.tez.auto.parallelism" ${PIG_TEZ_AUTO_PARALLELISM} "pig.properties"
load_config "pig.tez.grace.parallelism" ${PIG_TEZ_GRACE_PARALLELISM} "pig.properties"
load_config "pig.tez.opt.union.unsupported.storefuncs" ${PIG_TEZ_OPT_UNION_UNSUPPORTED_STOREFUNCS} "pig.properties"
load_config "pig.tez.opt.union.supported.storefuncs" ${PIG_TEZ_OPT_UNION_SUPPORTED_STOREFUNCS} "pig.properties"
load_config "pig.tez.configure.am.memory" ${PIG_TEZ_CONFIGURE_AM_MEMORY} "pig.properties"
load_config "pig.pretty.print.schema" ${PIG_PRETTY_PRINT_SCHEMA} "pig.properties"
load_config "pig.udf.profile" ${PIG_UDF_PROFILE} "pig.properties"
load_config "pig.udf.profile.frequency" ${PIG_UDF_PROFILE_FREQUENCY} "pig.properties"
load_config "pig.load.default.statements" ${PIG_LOAD_DEFAULT_STATEMENTS} "pig.properties"
load_config "pig.logfile" ${PIG_LOGFILE} "pig.properties"
load_config "pig.stats.output.size.reader" ${PIG_STATS_OUTPUT_SIZE_READER} "pig.properties"
load_config "pig.stats.output.size.reader.unsupported" ${PIG_STATS_OUTPUT_SIZE_READER_UNSUPPORTED} "pig.properties"
load_config "pig.streaming.environment" ${PIG_STREAMING_ENVIRONMENT} "pig.properties"
load_config "pig.streaming.ship.files" ${PIG_STREAMING_SHIP_FILES} "pig.properties"
load_config "pig.streaming.cache.files" ${PIG_STREAMING_CACHE_FILES} "pig.properties"
load_config "pig.streaming.udf.python.command" ${PIG_STREAMING_UDF_PYTHON_COMMAND} "pig.properties"
load_config "pig.disable.counter" ${PIG_DISABLE_COUNTER} "pig.properties"
load_config "pig.script.max.size" ${PIG_SCRIPT_MAX_SIZE} "pig.properties"
load_config "pig.error-handling.enabled" ${PIG_ERROR_HANDLING_ENABLED} "pig.properties"
load_config "pig.error-handling.min.error.records" ${PIG_ERROR_HANDLING_MIN_ERROR_RECORDS} "pig.properties"
load_config "pig.error-handling.error.threshold" ${PIG_ERROR_HANDLING_ERROR_THRESHOLD} "pig.properties"
load_config "pig.random.sampler.sample.size" ${PIG_RANDOM_SAMPLER_SAMPLE_SIZE} "pig.properties"
load_config "pig.maxCombinedSplitSize" ${PIG_MAXCOMBINEDSPLITSIZE} "pig.properties"
load_config "pig.auto.local.enabled" ${PIG_AUTO_LOCAL_ENABLED} "pig.properties"
load_config "pig.auto.local.input.maxbytes" ${PIG_AUTO_LOCAL_INPUT_MAXBYTES} "pig.properties"
load_config "pig.blacklist" ${PIG_BLACKLIST} "pig.properties"
load_config "pig.whitelist" ${PIG_WHITELIST} "pig.properties"
load_config "pig.notifiaction.listener" ${PIG_NOTIFIACTION_LISTENER} "pig.properties"
load_config "pig.notifiaction.listener.arg" ${PIG_NOTIFIACTION_LISTENER_ARG} "pig.properties"
load_config "pig.default.load.func" ${PIG_DEFAULT_LOAD_FUNC} "pig.properties"
load_config "pig.default.store.func" ${PIG_DEFAULT_STORE_FUNC} "pig.properties"
load_config "pig.ats.enabled" ${PIG_ATS_ENABLED} "pig.properties"
load_config "pig.sql.type" ${PIG_SQL_TYPE} "pig.properties"
load_config "pig.location.check.strict" ${PIG_LOCATION_CHECK_STRICT} "pig.properties"
load_config "pig.delete.temp.files" ${PIG_DELETE_TEMP_FILES} "pig.properties"
load_config "pig.bzip.use.hadoop.inputformat" ${PIG_BZIP_USE_HADOOP_INPUTFORMAT} "pig.properties"
load_config "pig.use.overriden.hadoop.configs" ${PIG_USE_OVERRIDEN_HADOOP_CONFIGS} "pig.properties"
load_config "pig.sort.readonce.loadfuncs" ${PIG_SORT_READONCE_LOADFUNCS} "pig.properties"
load_config "stop.on.failure" ${STOP_ON_FAILURE} "pig.properties"
load_config "udf.import.list" ${UDF_IMPORT_LIST} "pig.properties"
load_config "verbose" ${VERBOSE} "pig.properties"
