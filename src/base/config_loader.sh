#!/usr/bin/env bash
function load_config() {
  if [[ "$2" != "NULL" ]]
    then
      printf "$1=$2\n" >> "${PIG_CONF_DIR}/$3"
  fi
}

printf "" > "${PIG_CONF_DIR}/pig.properties"
load_config "aggregate.warning" ${AGGREGATE_WARNING:=true} "pig.properties"
load_config "brief" ${BRIEF:=false} "pig.properties"
load_config "debug" ${DEBUG:=INFO} "pig.properties"
load_config "exectype" ${EXECTYPE:=mapreduce} "pig.properties"
load_config "file" ${FILE:=NULL} "pig.properties"
load_config "hcat.bin" ${HCAT_BIN:=NULL} "pig.properties"
load_config "jar" ${JAR:=NULL} "pig.properties"
load_config "log4jconf" ${LOG4JCONF:=} "pig.properties"
load_config "opt.multiquery" ${OPT_MULTIQUERY:=true} "pig.properties"
load_config "opt.fetch" ${OPT_FETCH:=true} "pig.properties"
load_config "pig.cachedbag.memusage" ${PIG_CACHEDBAG_MEMUSAGE:=0.2} "pig.properties"
load_config "pig.skewedjoin.reduce.memusage" ${PIG_SKEWEDJOIN_REDUCE_MEMUSAGE:=0.3} "pig.properties"
load_config "pig.exec.nocombiner" ${PIG_EXEC_NOCOMBINER:=false} "pig.properties"
load_config "pig.exec.nocombiner.reducer" ${PIG_EXEC_NOCOMBINER_REDUCER:=auto} "pig.properties"
load_config "pig.exec.mapPartAgg" ${PIG_EXEC_MAPPARTAGG:=false} "pig.properties"
load_config "pig.exec.mapPartAgg.minReduction" ${PIG_EXEC_MAPPARTAGG_MINREDUCTION:=10} "pig.properties"
load_config "pig.exec.reducers.bytes.per.reducer" ${PIG_EXEC_REDUCERS_BYTES_PER_REDUCER:=1000000000} "pig.properties"
load_config "pig.exec.reducers.max" ${PIG_EXEC_REDUCERS_MAX:=999} "pig.properties"
load_config "pig.exec.reducer.estimator" ${PIG_EXEC_REDUCER_ESTIMATOR:=NULL} "pig.properties"
load_config "pig.exec.reducer.estimator.arg" ${PIG_EXEC_REDUCER_ESTIMATOR_ARG:=NULL} "pig.properties"
load_config "pig.tmpfilecompression" ${PIG_TMPFILECOMPRESSION:=NULL} "pig.properties"
load_config "pig.tmpfilecompression.codec" ${PIG_TMPFILECOMPRESSION_CODEC:=gzip} "pig.properties"
load_config "pig.tmpfilecompression.storage" ${PIG_TMPFILECOMPRESSION_STORAGE:=tfile} "pig.properties"
load_config "pig.noSplitCombination" ${PIG_NOSPLITCOMBINATION:=NULL} "pig.properties"
load_config "pig.additional.jars.uris" ${PIG_ADDITIONAL_JARS_URIS:=NULL} "pig.properties"
load_config "pig.datetime.default.tz" ${PIG_DATETIME_DEFAULT_TZ:=NULL} "pig.properties"
load_config "pig.artifacts.download.location" ${PIG_ARTIFACTS_DOWNLOAD_LOCATION:=~/.groovy/grapes} "pig.properties"
load_config "pig.user.cache.enabled" ${PIG_USER_CACHE_ENABLED:=false} "pig.properties"
load_config "pig.user.cache.location" ${PIG_USER_CACHE_LOCATION:=/tmp} "pig.properties"
load_config "pig.user.cache.replication" ${PIG_USER_CACHE_REPLICATION:=10} "pig.properties"
load_config "pig.spill.size.threshold" ${PIG_SPILL_SIZE_THRESHOLD:=5000000} "pig.properties"
load_config "pig.spill.gc.activation.size" ${PIG_SPILL_GC_ACTIVATION_SIZE:=NULL} "pig.properties"
load_config "pig.spill.memory.usage.threshold.fraction" ${PIG_SPILL_MEMORY_USAGE_THRESHOLD_FRACTION:=0.7} "pig.properties"
load_config "pig.spill.collection.threshold.fraction" ${PIG_SPILL_COLLECTION_THRESHOLD_FRACTION:=0.7} "pig.properties"
load_config "pig.spill.unused.memory.threshold.size" ${PIG_SPILL_UNUSED_MEMORY_THRESHOLD_SIZE:=367001600} "pig.properties"
load_config "pig.join.replicated.max.bytes" ${PIG_JOIN_REPLICATED_MAX_BYTES:=1000000000} "pig.properties"
load_config "pig.schematuple" ${PIG_SCHEMATUPLE:=false} "pig.properties"
load_config "pig.schematuple.udf" ${PIG_SCHEMATUPLE_UDF:=false} "pig.properties"
load_config "pig.schematuple.load" ${PIG_SCHEMATUPLE_LOAD:=false} "pig.properties"
load_config "pig.schematuple.fr_join" ${PIG_SCHEMATUPLE_FR_JOIN:=false} "pig.properties"
load_config "pig.schematuple.merge_join" ${PIG_SCHEMATUPLE_MERGE_JOIN:=false} "pig.properties"
load_config "pig.output.lazy" ${PIG_OUTPUT_LAZY:=false} "pig.properties"
load_config "pig.output.committer.recovery.support" ${PIG_OUTPUT_COMMITTER_RECOVERY_SUPPORT:=true} "pig.properties"
load_config "pig.tez.auto.parallelism" ${PIG_TEZ_AUTO_PARALLELISM:=true} "pig.properties"
load_config "pig.tez.grace.parallelism" ${PIG_TEZ_GRACE_PARALLELISM:=true} "pig.properties"
load_config "pig.tez.opt.union.unsupported.storefuncs" ${PIG_TEZ_OPT_UNION_UNSUPPORTED_STOREFUNCS:=org.apache.hcatalog.pig.HCatStorer,org.apache.hive.hcatalog.pig.HCatStorer} "pig.properties"
load_config "pig.tez.opt.union.supported.storefuncs" ${PIG_TEZ_OPT_UNION_SUPPORTED_STOREFUNCS:=NULL} "pig.properties"
load_config "pig.tez.configure.am.memory" ${PIG_TEZ_CONFIGURE_AM_MEMORY:=false} "pig.properties"
load_config "pig.pretty.print.schema" ${PIG_PRETTY_PRINT_SCHEMA:=false} "pig.properties"
load_config "pig.udf.profile" ${PIG_UDF_PROFILE:=false} "pig.properties"
load_config "pig.udf.profile.frequency" ${PIG_UDF_PROFILE_FREQUENCY:=100} "pig.properties"
load_config "pig.load.default.statements" ${PIG_LOAD_DEFAULT_STATEMENTS:=NULL} "pig.properties"
load_config "pig.logfile" ${PIG_LOGFILE:=NULL} "pig.properties"
load_config "pig.stats.output.size.reader" ${PIG_STATS_OUTPUT_SIZE_READER:=NULL} "pig.properties"
load_config "pig.stats.output.size.reader.unsupported" ${PIG_STATS_OUTPUT_SIZE_READER_UNSUPPORTED:=NULL} "pig.properties"
load_config "pig.streaming.environment" ${PIG_STREAMING_ENVIRONMENT:=NULL} "pig.properties"
load_config "pig.streaming.ship.files" ${PIG_STREAMING_SHIP_FILES:=NULL} "pig.properties"
load_config "pig.streaming.cache.files" ${PIG_STREAMING_CACHE_FILES:=NULL} "pig.properties"
load_config "pig.streaming.udf.python.command" ${PIG_STREAMING_UDF_PYTHON_COMMAND:=python} "pig.properties"
load_config "pig.disable.counter" ${PIG_DISABLE_COUNTER:=true} "pig.properties"
load_config "pig.script.max.size" ${PIG_SCRIPT_MAX_SIZE:=10240} "pig.properties"
load_config "pig.error-handling.enabled" ${PIG_ERROR_HANDLING_ENABLED:=false} "pig.properties"
load_config "pig.error-handling.min.error.records" ${PIG_ERROR_HANDLING_MIN_ERROR_RECORDS:=0} "pig.properties"
load_config "pig.error-handling.error.threshold" ${PIG_ERROR_HANDLING_ERROR_THRESHOLD:=0.0f} "pig.properties"
load_config "pig.random.sampler.sample.size" ${PIG_RANDOM_SAMPLER_SAMPLE_SIZE:=100} "pig.properties"
load_config "pig.maxCombinedSplitSize" ${PIG_MAXCOMBINEDSPLITSIZE:=NULL} "pig.properties"
load_config "pig.auto.local.enabled" ${PIG_AUTO_LOCAL_ENABLED:=false} "pig.properties"
load_config "pig.auto.local.input.maxbytes" ${PIG_AUTO_LOCAL_INPUT_MAXBYTES:=100000000} "pig.properties"
load_config "pig.blacklist" ${PIG_BLACKLIST:=NULL} "pig.properties"
load_config "pig.whitelist" ${PIG_WHITELIST:=NULL} "pig.properties"
load_config "pig.notifiaction.listener" ${PIG_NOTIFIACTION_LISTENER:=NULL} "pig.properties"
load_config "pig.notifiaction.listener.arg" ${PIG_NOTIFIACTION_LISTENER_ARG:=NULL} "pig.properties"
load_config "pig.default.load.func" ${PIG_DEFAULT_LOAD_FUNC:=NULL} "pig.properties"
load_config "pig.default.store.func" ${PIG_DEFAULT_STORE_FUNC:=NULL} "pig.properties"
load_config "pig.ats.enabled" ${PIG_ATS_ENABLED:=true} "pig.properties"
load_config "pig.sql.type" ${PIG_SQL_TYPE:=hcat} "pig.properties"
load_config "pig.location.check.strict" ${PIG_LOCATION_CHECK_STRICT:=false} "pig.properties"
load_config "pig.delete.temp.files" ${PIG_DELETE_TEMP_FILES:=true} "pig.properties"
load_config "pig.bzip.use.hadoop.inputformat" ${PIG_BZIP_USE_HADOOP_INPUTFORMAT:=true} "pig.properties"
load_config "pig.use.overriden.hadoop.configs" ${PIG_USE_OVERRIDEN_HADOOP_CONFIGS:=false} "pig.properties"
load_config "pig.sort.readonce.loadfuncs" ${PIG_SORT_READONCE_LOADFUNCS:=NULL} "pig.properties"
load_config "stop.on.failure" ${STOP_ON_FAILURE:=false} "pig.properties"
load_config "udf.import.list" ${UDF_IMPORT_LIST:=NULL} "pig.properties"
load_config "verbose" ${VERBOSE:=false} "pig.properties"
